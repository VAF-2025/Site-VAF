<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="imagens/logo-vozes-200.jpg" type="image/x-icon">
    <title>Artigos - VAF</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <!-- HEADER -->
    <div data-component="header"></div>

    <!-- SE√á√ÉO DE ARTIGOS DA CATEGORIA -->
    <section class="category-section">
        <div class="container">
            <h2 id="category-title" class="section-title">Carregando...</h2>
            <p id="category-description" class="section-description"></p>

            <div id="category-articles" class="articles-grid"></div>

            <!-- Mensagem quando n√£o h√° artigos -->
            <div id="no-articles" class="no-articles-container">
                <p class="no-articles-text">
                    üòî Nenhum artigo encontrado nesta categoria.
                </p>
                <a href="index.html" class="back-button">
                    ‚Üê Voltar ao In√≠cio
                </a>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <div data-component="footer"></div>

    <script>
        // Mapeamento de categorias
        const CATEGORIAS = {
            "geopolitica": { nome: "üåç Geopol√≠tica", descricao: "An√°lises sobre pol√≠tica internacional e rela√ß√µes globais", filtro: "Geopol√≠tica" },
            "comercio-exterior": { nome: "üì¶ Com√©rcio Exterior", descricao: "Tend√™ncias e an√°lises do mercado internacional", filtro: "Com√©rcio Exterior" },
            "moda": { nome: "üëó Moda", descricao: "O universo da moda al√©m das passarelas", filtro: "Moda" },
            "meio-ambiente": { nome: "üå± Meio Ambiente", descricao: "Sustentabilidade e quest√µes ambientais globais", filtro: "Meio Ambiente" },
            "globalizacao": { nome: "üåê Globaliza√ß√£o", descricao: "O mundo conectado e suas transforma√ß√µes", filtro: "Globaliza√ß√£o" },
            "cinema": { nome: "üé¨ Cinema", descricao: "An√°lises e cr√≠ticas cinematogr√°ficas", filtro: "Cinema" },
            "audiovisual": { nome: "üì∫ Audiovisual", descricao: "Conte√∫do multim√≠dia e produ√ß√µes audiovisuais", filtro: "Audiovisual" },
            "narrativas": { nome: "üìñ Narrativas", descricao: "Hist√≥rias reais que precisam ser contadas", filtro: "Narrativas" }
        };

        async function loadCategoryArticles() {
            const params = new URLSearchParams(window.location.search);
            const catSlug = params.get("cat");

            const titleEl = document.getElementById("category-title");
            const descEl = document.getElementById("category-description");
            const container = document.getElementById("category-articles");
            const noArticles = document.getElementById("no-articles");

            if (!catSlug || !CATEGORIAS[catSlug]) {
                titleEl.textContent = "Categoria n√£o encontrada";
                descEl.textContent = "Verifique o link e tente novamente.";
                noArticles.style.display = "block";
                return;
            }

            const categoria = CATEGORIAS[catSlug];
            titleEl.textContent = categoria.nome;
            descEl.textContent = categoria.descricao;
            document.title = `${categoria.nome} - VAF`;

            try {
                const response = await fetch("./posts/allposts.json", { cache: "no-store" });
                if (!response.ok) throw new Error("Arquivo n√£o encontrado");

                const posts = await response.json();

                const filtered = posts
                    .filter(post => post.category === categoria.filtro)
                    .reverse();

                if (filtered.length === 0) {
                    noArticles.style.display = "block";
                    return;
                }

                // Esconder mensagem se houver artigos
                noArticles.style.display = "none";

                filtered.forEach(post => {
                    container.insertAdjacentHTML("beforeend", `
                        <article class="article-card" onclick="location.href='posts/${post.filename}'">
                            <div class="article-image">
                                <img src="${post.image}" alt="${post.title}">
                                <span class="article-category">${post.category}</span>
                            </div>
                            <h3 class="article-title">${post.title}</h3>
                            <div class="article-meta">
                                <span>üë§ ${post.author}</span>
                                <span>üìÖ ${new Date(post.date).toLocaleDateString("pt-BR")}</span>
                            </div>
                        </article>
                    `);
                });

            } catch (err) {
                console.error("Erro:", err);
                noArticles.style.display = "block";
            }
        }

        document.addEventListener("DOMContentLoaded", loadCategoryArticles);
    </script>

    <script src="components/components.js"></script>
    <script src="scripts.js"></script>
</body>

</html>